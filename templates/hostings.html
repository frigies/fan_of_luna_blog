{% extends "base.html" %}

{% block title %}hostings{% endblock %}
{% block head %}
  {{ super() }}
  <script src="https://unpkg.com/htmx.org@1.9.2"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/hostings.css') }}">
{% endblock %}
    
{% block content %}
    <h1>Список хостингов</h1>

    <div class="filters">
        <form id="filter-form">
            <div class="filter-group">
                <label for="category">Категория:</label>
                <select id="category" name="category">
                    <option value="">Все категории</option>
                    {% for category in categories %}
                    <option value="{{ category.category_id }}">{{ category.category_name }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="filter-group">
                <label for="max_price">Макс. цена ($):</label>
                <input type="number" id="max_price" name="max_price" min="0" step="0.1" placeholder="например, 10">
            </div>

            <div class="filter-group">
                <label for="hosting_name">Название содержит:</label>
                <input type="text" id="hosting_name" name="hosting_name" placeholder="поиск по имени">
            </div>

            <div class="filter-group">
                <label for="favorite">Только избранные:</label>
                <input type="checkbox" id="favorite" name="favorite" value="true">
            </div>

            <div class="filter-group">
                <label for="status">Статус:</label>
                <input type="text" id="status" name="status" placeholder="например, Рекомендуется">
            </div>

            <div class="filter-group">
                <label for="max_risk">Макс. риск:</label>
                <input type="number" id="max_risk" name="max_risk" min="0" max="100" placeholder="0-100">
            </div>

            <div class="filter-group">
                <label for="location">Расположение:</label>
                <input type="text" id="location" name="location" placeholder="например, Словакия">
            </div>

            <div class="filter-group">
                <label for="sort_by">Сортировка:</label>
                <select id="sort_by" name="sort_by">
                    <option value="hosting_name">По имени</option>
                    <option value="min_price_in_dollars">По цене</option>
                    <option value="risk">По риску</option>
                    <option value="favorite">По избранному</option>
                </select>
                <select id="sort_order" name="sort_order">
                    <option value="asc">По возрастанию</option>
                    <option value="desc">По убыванию</option>
                </select>
            </div>

            <button type="button"
                    hx-get="/hostings_table" 
                    hx-target="#hostings_table" 
                    hx-include="#filter-form">
                Показать
            </button>
            
            <button type="button"
                    hx-get="/table" 
                    hx-target="#table"
                    hx-vals="{'category': '', 'max_price': '', 'hosting_name': '', 'favorite': '', 'status': '', 'max_risk': '', 'location': '', 'sort_by': 'hosting_name', 'sort_order': 'asc'}"
                    onclick="document.getElementById('filter-form').reset()">
                Очистить фильтры
            </button>
        </form>
    </div>

    <div id="hostings_table">
        <!-- Таблица загружается сюда -->
    </div>
{% endblock %}